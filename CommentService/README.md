# CommentsService
Miriam Assraf, Sarel Micha, Yosi Bukris

Our service manages comments over blogs, by using another service - BlogService. It also consumes from UserService, for user authentication, and CustomerSupportService for <br/>tagging customer support on comments.<br/>
The data is stored on a relational database - PostgreSQL. Additionaly, the service consumes from Kafka topic.
<br/><br/>
The service runs locally, using dev properties file. Prod enviorment is deployed to AWS Elastic Beanstalk and can be used using Swagger-UI:<br/>
UserManagmentService :<br/>
http://userservice-env.eba-nvpyekb5.eu-central-1.elasticbeanstalk.com/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config<br/>
<br/>
BlogManagmentService :<br/>
http://blogservice-env.eba-rkjsykfp.eu-central-1.elasticbeanstalk.com/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config<br/>
<br/>
SupportManagmentService :<br/>
http://ticketservice-env.eba-wmt8hjbz.eu-central-1.elasticbeanstalk.com/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config<br/>
<br/>
CommentsService :<br/>
http://commentservice-env.eba-xh7dt3hb.eu-central-1.elasticbeanstalk.com/swagger-ui/index.html?configUrl=/v3/api-docs/swagger-config<br/>
 <br/>
*Kafka server hosted on Cloudkarafka<br/>
<br/>
Comment attributes:<br/>
id - unique id generated by JPA<br/>
user - User type, including email and password attributes<br/>
blog – Blog type, including email(for blog creator), blogId and productId<br/>
createdTimestamp - Date type, call current time when created<br/>
updatedTimestamp - Date type, call current time when updated<br/>
tagSupport - Boolean type, set to false by default<br/>
country - String type<br/>
commentType - COMMENT_TYPE enum, including TEXT and REACTION values<br/>
commentContent - Map type<br/>
<br/>
Request body is of JSON type as the following:<br/>
{<br/>
"user":{<br/>
"email":"yosi@afeka.ac.il",<br/>
"password":"123456"<br/>
},<br/>
"blog":{<br/>
"bloggerEmail":"miriam@gmail.com",<br/>
"productId":"pju39l2",<br/>
"blogId":"6012c0279b00102586afe4cb"<br/>
},<br/>
"country":"Israel",<br/>
"commentType":"REACTION",<br/>
"commentContent":{<br/>
"body":"LIKE"<br/>
}<br/>
}<br/>
<br/>
If entered id, cratedTimestamp or updatedTimestamp, the values will be ignored.<br/>
tagSupport is set to false by default, may enter as true only for comments with commentType=TEXT, else will be ignored.<br/>
<br/>
HTTP methods:<br/>
____________________________________________________________________________________________________________________________________________________________________________
POST comments/{blogid} 
path variable - blogid 
body - CommentBoundary
Requests blog from blogService and creates a new comment for that blog.
The method confirms the blog exists, authenticates the user by consuming from userService and checks if the user already reacted to that blog if comment type is REACTION. 
The service allows one reaction for each blog.
____________________________________________________________________________________________________________________________________________________________________________
GET comments?blogId={blogid}&size={size}&page={page}?filterType={filterType}&filterValue={filterValue}&sortBy={sortArrt}&sortOrder={order} 
request params – blogid, size, page, filterType, filterValue, sortByType, order 
The method returns an array of all matching comments. Results can be filtered by using request params.
____________________________________________________________________________________________________________________________________________________________________________
GET comments/{commentid} 
path variable - commentid 
The method returns a specific comment by given id.
____________________________________________________________________________________________________________________________________________________________________________
PUT comments/{commentId} 
path variable - commentId 
body – CommentBoundary
Requests comment from service and updates with given comment.
The method verifies the user is the one who created the comment and autheticates him by userService.
____________________________________________________________________________________________________________________________________________________________________________
DELETE comments/admin/{email}?password={password}&blogId={blogId} 
path variable – email 
request param – password, blogId
The method delets all comments (or all comments of a specific blog if blogId is entered). Only admins are allowed to perform this operation, and the user is authenticated by
UserService and confirms he has an admin role.
____________________________________________________________________________________________________________________________________________________________________________
DELETE comments/{email}/{commentid}?password={password} 
path variable - email, commentId 
request param - password 
The method deletes a specific comment.  Only admins and creators are allowed to perform this operation, and the user is authenticated.
<br/>
*If any verification fails, an error message is returned.
